:root{
  --bg:#000;  --box-alpha:.82;

  /* макет 3×30% */
  --gap:5%;

  /* палитра «мутных» цветов (RGB без альфы) */
  --c-metaphysics: 122 30 30;
  --c-ethics:      138 74 17;
  --c-politics:     92 58 115;
  --c-economics:    42 74 91;
  --c-science:      31 58 91;
  --c-technology:   52 78 65;
  --c-health:       91 58 58;
  --c-education:    63 81 102;
  --c-art:          74 59 78;
  --c-culture:      61 75 79;
  --c-ecology:      46 77 58;
  --c-psychology:   77 58 46;
  --c-law:          30 58 58;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{ margin:0; background:var(--bg); color:#fff; font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

/* ===== макет по 30% ===== */
.layout{
  display:grid;
  grid-template-columns: 30% 30% 30%;
  column-gap: var(--gap);
  row-gap:24px;
  padding:1.5% 2%;
  align-items:start;
  min-height:100vh;
}
.col{ min-height:0; }
.col-left{
  border:1px solid rgba(255,255,255,.06);
  border-radius:14px; background:rgba(255,255,255,.02);
  min-height:60vh;
}
.col-center{
  border:1px solid rgba(255,255,255,.10);
  border-radius:14px; background:rgba(255,255,255,.03);
  padding:14px; max-height:calc(100vh - 3%); overflow:auto;
}
.col-right{
  border:1px solid rgba(255,255,255,.10);
  border-radius:14px; background:rgba(255,255,255,.03);
  padding:12px; position:sticky; top:1.5%;
  max-height:calc(100vh - 3%); overflow:auto;
}

/* ===== карточки ===== */
.card-grid{
  display:grid; gap:10px;
  grid-template-columns: repeat(auto-fill, minmax(72px, 1fr));
}

/* ссылки-карточки */
.card{
  aspect-ratio:1/1;
  border:1px solid rgba(255,255,255,.14);
  border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  text-decoration:none; color:#fff; font-weight:700;
  transition:transform .12s ease, box-shadow .12s ease, opacity .12s;
}
.card:hover{ transform:translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,.35); }
.card:focus-visible{ outline:2px solid rgba(255,255,255,.7); outline-offset:2px; }

/* цвет по теме */
.t-metaphysics { background: rgba(var(--c-metaphysics), var(--box-alpha)); }
.t-ethics      { background: rgba(var(--c-ethics), var(--box-alpha)); }
.t-politics    { background: rgba(var(--c-politics), var(--box-alpha)); }
.t-economics   { background: rgba(var(--c-economics), var(--box-alpha)); }
.t-science     { background: rgba(var(--c-science), var(--box-alpha)); }
.t-technology  { background: rgba(var(--c-technology), var(--box-alpha)); }
.t-health      { background: rgba(var(--c-health), var(--box-alpha)); }
.t-education   { background: rgba(var(--c-education), var(--box-alpha)); }
.t-art         { background: rgba(var(--c-art), var(--box-alpha)); }
.t-culture     { background: rgba(var(--c-culture), var(--box-alpha)); }
.t-ecology     { background: rgba(var(--c-ecology), var(--box-alpha)); }
.t-psychology  { background: rgba(var(--c-psychology), var(--box-alpha)); }
.t-law         { background: rgba(var(--c-law), var(--box-alpha)); }

/* фиксированная подсветка выбранной темы */
.card-grid[data-filter] .card{ opacity:.22; }
.card-grid[data-filter] .card.is-match{ opacity:1; }

/* ===== правая панель ===== */
.panel-title{ margin:0 0 10px; font-size:16px; font-weight:800; }
.topics{ list-style:none; margin:0; padding:0; display:grid; gap:8px; }
.topic{
  display:grid; grid-template-columns:18px 1fr auto; gap:8px; align-items:center;
  padding:8px 10px; border:1px solid rgba(255,255,255,.14);
  border-radius:10px; background:rgba(255,255,255,.04);
  cursor:pointer; user-select:none;
}
.topic .sw{ width:18px; height:18px; border-radius:4px; border:1px solid rgba(255,255,255,.25); }
.topic .nm{ font-weight:700; }
.topic .ct{ opacity:.85; font-variant-numeric: tabular-nums; }

/* активная тема остаётся выделенной */
.topic.is-active{ outline:2px solid rgba(255,255,255,.55); outline-offset:2px; background:rgba(255,255,255,.07); }

/* цвет свотчей */
.topic[data-key="metaphysics"] .sw{ background: rgb(var(--c-metaphysics)); }
.topic[data-key="ethics"]      .sw{ background: rgb(var(--c-ethics)); }
.topic[data-key="politics"]    .sw{ background: rgb(var(--c-politics)); }
.topic[data-key="economics"]   .sw{ background: rgb(var(--c-economics)); }
.topic[data-key="science"]     .sw{ background: rgb(var(--c-science)); }
.topic[data-key="technology"]  .sw{ background: rgb(var(--c-technology)); }
.topic[data-key="health"]      .sw{ background: rgb(var(--c-health)); }
.topic[data-key="education"]   .sw{ background: rgb(var(--c-education)); }
.topic[data-key="art"]         .sw{ background: rgb(var(--c-art)); }
.topic[data-key="culture"]     .sw{ background: rgb(var(--c-culture)); }
.topic[data-key="ecology"]     .sw{ background: rgb(var(--c-ecology)); }
.topic[data-key="psychology"]  .sw{ background: rgb(var(--c-psychology)); }
.topic[data-key="law"]         .sw{ background: rgb(var(--c-law)); }

/* адаптив */
@media (max-width:1100px){
  .layout{ grid-template-columns:1fr; column-gap:0; row-gap:16px; }
  .col-right{ position:static; max-height:none; }
}
