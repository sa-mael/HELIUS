/* Grayscale tokens */
html { color-scheme: light dark; }
html[data-theme="light"]{
  --bg:#ffffff; --fg:#151515; --muted:#7a7a7a; --line:#e7e7e7;
  --panel:#f7f7f7; --panelDeep:#efefef; --card:#ffffff; --ink:#ff0000;
  --shadow:0 10px 30px rgba(0,0,0,.08);
}
html[data-theme="dark"]{
  --bg:#0b0b0b; --fg:#ececec; --muted:#a2a2a2; --line:#1b1b1b;
  --panel:#111111; --panelDeep:#0e0e0e; --card:#121212; --ink:#ff0000;
  --shadow:0 10px 30px rgba(0,0,0,.35);
}
.back-fab{position:fixed;left:18px;bottom:18px;z-index:50;border:1px solid #1e1e1e;background:#0f0f0f;color:#e9e9e9;padding:10px 14px;border-radius:999px;cursor:pointer}
html[data-theme="light"] .back-fab{background:#efefef;color:#111;border-color:#e6e6e6}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--fg);
  font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}

/* Always-visible back button */
.back-fab{
  position:fixed; left:18px; bottom:18px; z-index:50;
  border:1px solid var(--line); background:var(--panelDeep); color:var(--fg);
  padding:10px 14px; border-radius:999px; cursor:pointer; box-shadow:var(--shadow);
}

/* Sidebar */
/* Left app menu (replaces the old .sidebar) */
.menu-card{
  position:fixed; inset:16px auto 16px 16px; width:248px; z-index:20;
  background:var(--panel); border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow);
  padding:12px; display:flex; flex-direction:column;
}
.menu{ display:flex; flex-direction:column; gap:6px }
.menu-item{
  display:flex; align-items:center; gap:10px;
  padding:10px; border-radius:12px; border:1px solid transparent;
  color:var(--fg); background:transparent; cursor:pointer;
  transition:background .15s ease, transform .15s ease, border-color .15s ease;
}
.menu-item:hover{ background:rgba(255,255,255,.04) }
.menu-item:active{ transform:scale(.98) }
.menu-item.danger{ border-color:#2b2b2b }
.menu-item .icon{ width:24px; height:24px; display:grid; place-items:center }
.menu-item .label{ font-weight:600 }

/* Notes popover */
.notes-popover{
  position:absolute; left:264px; top:12px; width:280px;
  background:var(--panel); border:1px solid var(--line); border-radius:12px; box-shadow:var(--shadow);
  padding:10px; display:none;
}
.notes-popover[aria-hidden="false"]{ display:block }
#notes-form textarea{
  width:100%; resize:vertical; min-height:110px; padding:10px;
  border:1px solid var(--line); border-radius:10px; background:transparent; color:var(--fg);
}
.notes-actions{ display:flex; gap:8px; margin-top:8px }
.btn{ border:1px solid var(--line); background:transparent; color:var(--fg); padding:8px 12px; border-radius:10px; cursor:pointer }
.btn.primary{ border-color:var(--ink) }
.notes-hint{ margin:6px 0 0; color:var(--muted) }

/* Shift doc layout to the right to make space for menu */
.doc-grid{ margin-left:280px } /* keep other margins as-is */

/* Small screens: hide menu */
@media (max-width:860px){
  .menu-card{ transform:translateX(-270px) }
.doc-grid{margin-left:280px}
.topbar{left:280px}
}


/* Top bar */
.topbar{
  position:fixed; left:292px; right:24px; top:16px; height:60px; z-index:20;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  background:var(--panel); border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow);
  padding:0 12px;
}
.tabs{ display:flex; gap:8px }
.tab{ padding:8px 10px; border-radius:10px; color:var(--fg); text-decoration:none }
.tab.is-active{ background:rgba(255,255,255,.06) }
.top-actions{ display:flex; align-items:center; gap:10px }
.search input{
  width:240px; padding:10px 12px; border:1px solid var(--line); border-radius:10px; background:transparent; color:var(--fg);
}
.btn, .btn-ghost{
  border:1px solid var(--line); background:transparent; color:var(--fg);
  padding:9px 12px; border-radius:10px; cursor:pointer;
}
.btn{ border-color:var(--ink) }

.user{ position:relative }
.avatar-btn{
  width:34px; height:34px; border-radius:50%; border:1px solid var(--line);
  background:var(--panelDeep); color:var(--fg); cursor:pointer;
}
.menu{
  position:absolute; right:0; top:42px; display:none; min-width:160px;
  background:var(--panel); border:1px solid var(--line); border-radius:12px; box-shadow:var(--shadow);
}
.menu a{ display:block; padding:8px 10px; color:var(--fg); text-decoration:none }
.menu a:hover{ background:rgba(255,255,255,.06) }
.menu.show{ display:block }

/* Doc grid (pulled in from edges; readable) */
.doc-grid{
  margin-left:292px; margin-right:32px;
  margin-top:96px; margin-bottom:18px;
  display:grid; grid-template-columns: 1fr 320px; gap:20px;
}

/* Center doc stream */
.doc{
  background:var(--panel); border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow);
  padding:16px; position:relative; overflow:hidden;
}
.watermark{
  position:absolute; right:-30px; bottom:8px; pointer-events:none;
  color:var(--muted); opacity:.05; font-weight:900; font-size:3rem; letter-spacing:.06em;
  transform:rotate(-6deg);
}

/* Hero */
.hero{
  border:1px solid var(--line); border-radius:14px; overflow:hidden; background:var(--panelDeep);
  display:grid; grid-template-columns: 1fr;
}
.hero-img{
  height:180px;
  background-image:url('hilus.png');
  background-size:cover; background-position:center;
  filter:saturate(0%) contrast(110%);
}
.hero-text{ padding:14px 16px 16px }
.title{ font-size:clamp(2.2rem,2.8vw,3.2rem);
   letter-spacing:.1em;
    margin:0 0 6px
   }
  
  /* no text-align */

/* Blocks */
.block{
  border:1px solid var(--line); border-radius:14px; background:var(--card);
  padding:16px; margin:14px 0;
}
.block h2{ margin:0 0 8px }
.readable{ font-size:1.02rem; line-height:1.75 }   /* clearer text */
.two-col{ columns:2; column-gap:18px; padding-left:18px }
.cards{ display:grid; grid-template-columns:repeat(3,1fr); gap:12px }
.card{ border:1px solid var(--line); border-radius:12px; background:var(--panelDeep); padding:12px }

/* ToC column */
.toc-box{
  position:sticky; top:96px;
  background:var(--panel); border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow);
  padding:12px; margin-right:8px;
}
.toc-box h4{ margin:2px 0 8px }
.toc a{ display:block; padding:6px 6px; border-radius:8px; color:var(--fg); text-decoration:none }
.toc a:hover{ background:rgba(255,255,255,.05) }
.toc a.active{ background:rgba(255,255,255,.1) }
.help-box{ margin-top:12px }
.w100{ width:100% }

/* Self-test */
.test-btn{ margin-top:8px }

/* Modal */
.modal{ position:fixed; inset:0; display:none; z-index:60 }
.modal.show{ display:block }
.overlay{ position:absolute; inset:0; background:rgba(0,0,0,.5) }
.modal-card{
  position:absolute; right:32px; top:96px; width:min(540px, calc(100% - 64px));
  background:var(--panel); border:1px solid var(--line); border-radius:14px; box-shadow:var(--shadow);
}
.modal-head{ display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border-bottom:1px solid var(--line) }
.modal-body{ padding:14px }
.modal-foot{ padding:12px 14px; border-top:1px solid var(--line); display:flex; justify-content:flex-end; gap:8px }
.icon-btn{ border:1px solid var(--line); background:transparent; color:var(--fg); border-radius:10px; padding:6px 9px; cursor:pointer }

/* Responsive */
@media (max-width:1100px){
  .doc-grid{ grid-template-columns: 1fr }
  .toc{ display:none }
}
@media (max-width:860px){
  .sidebar{ transform:translateX(-270px) }
  .topbar{ left:16px; right:16px }
  .doc-grid{ margin-left:16px; margin-right:16px }
}
.back-fab{
  position:fixed; left:18px; bottom:18px; z-index:50;
  border:1px solid #1e1e1e; background:#0f0f0f; color:#e9e9e9;
  padding:10px 14px; border-radius:999px; cursor:pointer;
}
html[data-theme="light"] .back-fab{ background:#efefef; color:#111; border-color:#e6e6e6; }
a{
  color:var(--ink); text-decoration:none;
}




/* Left menu card */
.menu-card{position:fixed;left:16px;top:16px;bottom:16px;width:248px;z-index:30;background:var(--panel);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);padding:12px;display:flex;flex-direction:column}
.menu{display:flex;flex-direction:column;gap:6px;height:100%}
.menu-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border:1px solid transparent;border-radius:10px;color:var(--fg);background:transparent;cursor:pointer;transition:background .15s,border-color .15s,transform .15s}
.menu-item:hover{background:rgba(255,255,255,.04);transform:translateY(-1px)}
.menu-item.danger{color:#e66}
.notes-popover{position:fixed;min-width:280px;max-width:360px;border:1px solid var(--line);border-radius:12px;background:var(--card);box-shadow:var(--shadow);padding:12px;z-index:40;display:none}
.notes-popover[aria-hidden="false"]{display:block}
